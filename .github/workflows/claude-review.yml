name: Claude PR Review

on:
  pull_request:
    types: [opened, synchronize]

jobs:
  review:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: write
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - uses: anthropics/claude-code-action@v1
        with:
          anthropic_api_key: ${{ secrets.ANTHROPIC_API_KEY }}
          prompt: |
            このPRをレビューしてください。特に以下をチェックしてください：

            ## ドキュメント更新チェック
            1. README.md と README.ja.md の両方が必要に応じて更新されているか
            2. 新しいコマンドやオプションが追加された場合、両方のREADMEに記載されているか
            3. 片方だけ更新されて、もう片方が更新されていない場合は指摘してください

            ## 確認ポイント
            - src/ 配下のコードに機能追加・変更がある場合、READMEの更新が必要か検討
            - Usage表やConfiguration Options表に追加が必要か確認
            - 英語版と日本語版で内容が一致しているか確認
          claude_args: "--max-turns 5"
