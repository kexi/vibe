---
title: vibe clean
description: Delete current worktree and return to main repository
sidebar:
  order: 3
---

The `clean` command removes the current worktree and returns you to the main repository.

## Usage

```bash
vibe clean
```

## Options

### `--force`, `-f`

Skip confirmation prompt when uncommitted changes exist.

```bash
vibe clean --force
```

### `--delete-branch`

Delete the branch after removing the worktree.

```bash
vibe clean --delete-branch
```

### `--keep-branch`

Keep the branch after removing the worktree. This overrides the `delete_branch` config setting.

```bash
vibe clean --keep-branch
```

### `-V`, `--verbose`

Show detailed output including git commands being executed.

```bash
vibe clean --verbose
```

### `-q`, `--quiet`

Suppress non-essential output.

```bash
vibe clean --quiet
```

## Configuration

Configure default behavior in `.vibe.toml`:

```toml
[clean]
delete_branch = true  # Delete branch by default when cleaning
```

| Option          | Default | Description                          |
| --------------- | ------- | ------------------------------------ |
| `delete_branch` | `false` | Delete branch after worktree removal |

### Fast Remove (Performance Optimization)

By default, vibe uses a fast removal strategy that moves the worktree directory to a temporary location and deletes it asynchronously in the background. This makes `vibe clean` feel instant even for large repositories.

Configure this in `~/.config/vibe/settings.json`:

```json
{
  "version": 3,
  "clean": {
    "fast_remove": true
  }
}
```

| Option        | Default | Description                                        |
| ------------- | ------- | -------------------------------------------------- |
| `fast_remove` | `true`  | Use fast async deletion (move + background delete) |

**How it works:**

1. The worktree directory is instantly renamed to a hidden `.vibe-trash-*` directory (O(1) operation)
2. Git worktree metadata is cleaned up on the now-empty directory
3. The actual file deletion happens asynchronously in the background
4. Previous `.vibe-trash-*` directories are automatically cleaned up

**Note:** If the fast rename fails for any reason, it automatically falls back to traditional deletion.

## Behavior

### Safety Checks

Before removing a worktree, `vibe clean`:

1. Checks for uncommitted changes
2. Prompts for confirmation if changes exist
3. Runs pre-clean hooks
4. Removes the worktree
5. Runs post-clean hooks
6. Changes directory to the main repository

### Uncommitted Changes Warning

```
$ vibe clean
You have uncommitted changes. Are you sure you want to clean? (y/N)
```

If you have uncommitted changes, vibe will:

- Show a warning
- Ask for confirmation
- Only proceed if you explicitly confirm

## Hooks

The `clean` command supports hooks for cleanup tasks:

```toml
[hooks]
pre_clean = ["git stash"]
post_clean = ["echo 'Cleanup complete'"]
```

| Hook         | When                    | Working Directory |
| ------------ | ----------------------- | ----------------- |
| `pre_clean`  | Before worktree removal | Current worktree  |
| `post_clean` | After worktree removal  | Main repository   |

### Pre-clean Hook Example

Save your work before cleaning:

```toml
[hooks]
pre_clean = [
  "git stash --include-untracked",
  "echo 'Changes stashed'"
]
```

### Post-clean Hook Example

Clean up shared resources:

```toml
[hooks]
post_clean = [
  "docker-compose down",
  "echo 'Cleanup complete'"
]
```

## Workflow

```
worktree (current)
     │
     ├── pre_clean hooks run
     │
     ├── git worktree remove
     │
     ├── post_clean hooks run
     │
     └── cd to main repository
            │
            ▼
main repository (new current)
```

## Related

- [start](/commands/start/) - Create worktrees
- [Hooks](/configuration/hooks/) - Configure cleanup hooks
